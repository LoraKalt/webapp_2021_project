<main>
    <div class="fluid-container">
        <div class="row mx-auto">
            <div class="col-xl-2">
                <!-- Left column, empty for now -->
            </div>
            <div class="col-xl-8">
                <% if (loggedIn) {%>
                    <%- include('partials/newPost')  %>
                <% } %>
                <% posts.length > 0 && posts.forEach(post => { %>
                    <%- include('partials/post', {post: post})  %>
                <% }); %>
                <% if(posts.length <= 0) { %>
                    <div class="card mx-md-0 mx-3 my-3">
                        <div class="card-body">
                            <div class="row">
                                <div class="col-xl-10">
                                    <h2>There were no more posts to load...</h2>
                                </div>
                            </div>
                        </div>
                    </div>
                <% } %>
                <div class="row">
                    <div class="col-xl-6">
                        <% if(!isFirstPage) { %>
                            <a role="button" href="<%= `/page/${prevPage}` %>" class="btn btn-outline-primary btn-block">&larr; Newer posts</a>
                        <% } %>
                    </div>
                    <div class="<%= isFirstPage ? "col-xl-12" : "col-xl-6" %>">
                        <a role="button" href="<%= `/page/${nextPage}` %>" class="btn btn-outline-primary btn-block">Older posts &rarr;</a>
                    </div>
                </div>
            </div>
            <div class="col-xl-2">
                <div class="card mx-md-0 mx-3 my-3">
                    <div class="card-body">
                        <h5>Trending</h5>
                        <% trendingHashtags.forEach(hashtag => { %>
                            <a href="/hashtags/<%=hashtag %>">
                                <button class="btn btn-outline-secondary btn-sm btn-pill" type="button">
                                    #<%= hashtag %>
                                </button>
                            </a>
                        <% }); %>
                    </div>
                </div>
                <div class="card mx-md-0 mx-3 my-3">
                    <div class="card-body">
                        <h5>Who to follow</h5>
                        <% users.forEach(user => { %>
                            <div class="d-flex justify-content-between mb-1">
                                <strong><a href="<%=`/users/${user.username}`%>" class="text-secondary"><%= user.fullName %></a></strong>
                                <% if(loggedIn && currentUser.isFollowing(user._id)) { %>
                                    <a href="<%= `/users/${user.username}/unfollow?_method=POST` %>" class="btn btn-outline-primary btn-sm">Unfollow</a>
                                <% } else if(loggedIn) { %>
                                    <a href="<%= `/users/${user.username}/follow?_method=POST` %>" class="btn btn-outline-primary btn-sm">Follow</a>
                                <% } %>
                            </div>
                        <% }); %>
                    </div>
                </div>
            </div>
        </div>
    </div>
</main>